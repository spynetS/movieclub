{% load static %}
<nav class="p-5 flex items-center justify-between md:grid md:grid-cols-3 absolute top-0 h-20 bg-base-200 w-full z-50">
    <!-- Logo -->
    <a href="{% url 'dashboard' %}" class="flex flex-row items-center gap-2">
        <img src="{% static "logo.png" %}" alt="" class="h-10 w-auto" />
        <p class='font-bold text-2xl md:text-3xl'>MOVIECLUB</p>
        <p class="font-bold text-2xl md:text-3xl text-accent">HUB</p>
    </a>

    <!-- Hamburger (Mobile) -->
    <button id="menu-btn" class="md:hidden flex items-center px-3 py-2 border rounded hover:bg-base-300">
        <svg class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round"
                  d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
    </button>

    <!-- Links + Club Selector -->
    <div id="nav-links" class="hidden md:flex flex-col md:flex-row items-center gap-4 absolute md:static top-20 left-0 w-full md:w-auto bg-base-200 md:bg-transparent p-5 md:p-0">
        {% if user.is_authenticated %}
            <a href="{% url 'dashboard' %}" class="nav-link">Dashboard</a>
            <a href="{% url 'clubs' %}" class="nav-link">Club</a>
            <a href="{% url 'movies' %}" class="nav-link">Movies</a>
            <a href="{% url 'profile' %}" class="nav-link">Profile</a>

            <form hx-push-url="true" hx-on::after-swap="startClock()" hx-post="{% url "set-selected-club" %}" hx-trigger="input" hx-target="body">
                <select name="selected_club" class="select w-full md:w-auto">
                    <option disabled selected>
                        Select club to be active
                    </option>
                    {% for club in user.clubs.all %}
                        <option value="{{club.pk}}" {% if club.pk == user.selected_club.pk %}selected{% endif %}>
                            {{club}}
                        </option>
                    {% endfor %}
                </select>
                <input type="text" name="current_path" class="hidden" value="{{request.path}}" />
            </form>
        {% endif %}
    </div>

    <div>
    </div>

</nav>

<script>
 // Mobile toggle
 document.getElementById("menu-btn").addEventListener("click", () => {
     const nav = document.getElementById("nav-links");
     nav.classList.toggle("hidden");
 });

 // Active link highlight
 function highlightActiveLinks() {
     const currentPath = window.location.pathname;
     const navLinks = document.querySelectorAll('.nav-link');
     navLinks.forEach(link => {
         if (link.getAttribute('href') === currentPath) {
             link.classList.add('link-accent');
         } else {
             link.classList.remove('link-accent');
         }
     });
 }

 document.addEventListener("DOMContentLoaded", highlightActiveLinks);
 document.addEventListener("htmx:afterSwap", highlightActiveLinks);
</script>
